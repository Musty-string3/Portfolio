<div class="container">
  <%= flash[:notice] if flash[:notice] %>
  <div class="row">
    <table class="table">
      <tr>
        <td class="col-lg-2">
          <div class="text-right">
            <%= image_tag @user.get_profile_image(100, 100), class:"border border-dark rounded-circle" %>
          </div>
        </td>
        <td class="col-lg-7">
          <h4><%= @user.name %>
            <span style="float: right;">
              <% if @user == current_user %>
                <%= link_to "編集", edit_user_path(@user), class:"btn btn-outline-success" %>
                <%= link_to "いいねした一覧", likes_user_path(@user), class:"btn btn-outline-info" %>
              <% end %>
            </span>
          </h4>
          <div style="margin-top: 10px;">
            <h5><%= @user.introduction %></h5>
          </div>
          <!--フォロー、フォロワー数-->
          <div id="follow_<%= @user.id %>">
            <span style="color: red;">NG</span>
            <%= render 'public/relations/follow', user: @user %>
          </div>
          投稿数 <%= @post_counts %>投稿<br>
          <% if @user == current_user && @entries > 0 %>
            <%= link_to rooms_path do %>
              やりとり一覧(DMしているユーザーは<%= @entries %>人です)
            <% end %>
          <% end %>
          <!--DM機能-->
          <!--ログインしているユーザーが現在表示しているユーザーではないか & 相互フォローか？-->
          <% if @user != current_user && current_user.follow?(@user) && @user.follow?(current_user) %>
            <% if @isRoom %>
              <%= link_to 'チャットへGO!', room_path(@room_id) %>
            <% else %>
             <%= form_with model: @room, url: rooms_path, method: :post do |f| %>
               <%= fields_for @entry do |entry| %>
                 <%= entry.hidden_field :user_id, value: @user.id %>
               <% end %>
               <%= f.submit "チャットを始めてみよう！" %>
             <% end %>
            <% end %>
          <% end %>
          <!--DM機能ここまで-->
        </td>
        <td class="col-offset-lg-3"></td>
      </tr>
    </table>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <% if @user_posts.present? %>
        <%= render 'public/posts/index', posts: @user_posts, tag_counts: @tags %>
      <% else %>
        <h5>投稿はまだありません。</h5>
      <% end %>
    </div>
  </div>
</div>
